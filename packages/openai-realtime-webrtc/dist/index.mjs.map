{"version":3,"file":"index.mjs","sources":["../../../node_modules/eventemitter3/index.js","../src/core/WebRTCManager.ts","../src/core/OpenAIRealtimeService.ts","../src/core/constants.ts","../src/core/errors.ts"],"sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * Simple WebRTCManager for OpenAI Realtime API\n * \n * Handles WebRTC connections directly without unnecessary abstractions\n * Following OpenAI's simple example pattern\n */\n\nimport { EventEmitter } from 'eventemitter3';\n\nexport interface WebRTCConfig {\n  tokenEndpoint?: string;\n  model?: string;\n  iceServers?: RTCIceServer[];\n  audioConstraints?: MediaTrackConstraints;\n  debug?: boolean;\n}\n\nexport interface ConnectionState {\n  connectionState: RTCPeerConnectionState;\n  iceConnectionState: RTCIceConnectionState;\n  dataChannelState: RTCDataChannelState | null;\n  isAudioStreaming: boolean;\n}\n\nexport interface WebRTCEvents {\n  connected: () => void;\n  disconnected: (reason?: string) => void;\n  connectionFailed: (error: Error) => void;\n  dataChannelMessage: (data: string | ArrayBuffer) => void;\n  audioTrackReceived: (track: MediaStreamTrack) => void;\n  connectionStateChanged: (state: ConnectionState) => void;\n  dataChannelReady: () => void;\n}\n\n/**\n * Simple WebRTC Manager for OpenAI Realtime API\n */\nexport class WebRTCManager extends EventEmitter<WebRTCEvents> {\n  private peerConnection: RTCPeerConnection | null = null;\n  private dataChannel: RTCDataChannel | null = null;\n  private localStream: MediaStream | null = null;\n  private config: WebRTCConfig;\n  private ephemeralToken: string | null = null;\n\n  constructor(config: WebRTCConfig = {}) {\n    super();\n    this.config = {\n      iceServers: [{ urls: 'stun:stun.l.google.com:19302' }],\n      model: 'gpt-4o-realtime-preview-2024-12-17',\n      debug: false,\n      ...config\n    };\n  }\n\n  /**\n   * Initialize WebRTC connection\n   */\n  async initialize(): Promise<void> {\n    if (this.peerConnection) {\n      throw new Error('WebRTC already initialized');\n    }\n\n    try {\n      console.log('[WebRTC] Starting initialization...');\n      // Get ephemeral token if endpoint provided\n      if (this.config.tokenEndpoint) {\n        console.log('[WebRTC] Getting ephemeral token from:', this.config.tokenEndpoint);\n        this.ephemeralToken = await this.getEphemeralToken();\n        console.log('[WebRTC] Got ephemeral token');\n      } else {\n        console.log('[WebRTC] No token endpoint provided');\n      }\n\n      // Create peer connection\n      console.log('[WebRTC] Creating peer connection...');\n      this.peerConnection = new RTCPeerConnection({\n        iceServers: this.config.iceServers\n      });\n      this.setupPeerConnectionHandlers();\n\n      // Setup microphone\n      console.log('[WebRTC] Setting up microphone...');\n      this.localStream = await this.setupLocalMedia();\n      if (this.localStream) {\n        const audioTrack = this.localStream.getAudioTracks()[0];\n        if (audioTrack) {\n          this.peerConnection.addTrack(audioTrack, this.localStream);\n          console.log('[WebRTC] Added audio track');\n        }\n      }\n\n      // Create data channel\n      console.log('[WebRTC] Creating data channel...');\n      this.dataChannel = this.peerConnection.createDataChannel('oai-events', {\n        ordered: true\n      });\n      this.setupDataChannelHandlers();\n\n      // Complete negotiation if we have a token\n      if (this.ephemeralToken) {\n        console.log('[WebRTC] Starting negotiation...');\n        await this.completeNegotiation();\n      } else {\n        console.log('[WebRTC] No token available, skipping negotiation');\n      }\n    } catch (error) {\n      this.cleanup();\n      throw new Error(`Failed to initialize WebRTC: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * Send data through data channel\n   */\n  sendData(data: string | ArrayBuffer): void {\n    if (!this.dataChannel || this.dataChannel.readyState !== 'open') {\n      throw new Error('Data channel not available');\n    }\n    \n    // DataChannel.send() only accepts string for text data or ArrayBufferView for binary\n    if (typeof data === 'string') {\n      this.dataChannel.send(data);\n    } else {\n      // Convert ArrayBuffer to Uint8Array (which is an ArrayBufferView)\n      this.dataChannel.send(new Uint8Array(data));\n    }\n  }\n\n  /**\n   * Check if connected\n   */\n  isConnected(): boolean {\n    return this.peerConnection?.connectionState === 'connected';\n  }\n\n  /**\n   * Check if data channel is open\n   */\n  isDataChannelOpen(): boolean {\n    return this.dataChannel?.readyState === 'open';\n  }\n\n  /**\n   * Get connection state\n   */\n  getConnectionState(): ConnectionState {\n    return {\n      connectionState: this.peerConnection?.connectionState || 'new',\n      iceConnectionState: this.peerConnection?.iceConnectionState || 'new',\n      dataChannelState: this.dataChannel?.readyState || null,\n      isAudioStreaming: !!this.localStream\n    };\n  }\n\n  /**\n   * Close connection\n   */\n  async close(): Promise<void> {\n    this.cleanup();\n    this.emit('disconnected');\n  }\n\n  /**\n   * Dispose manager\n   */\n  dispose(): void {\n    this.cleanup();\n    this.removeAllListeners();\n  }\n\n  // Private methods\n\n  private async getEphemeralToken(): Promise<string> {\n    if (!this.config.tokenEndpoint) {\n      throw new Error('Token endpoint not configured');\n    }\n\n    const response = await fetch(this.config.tokenEndpoint, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' }\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to get token: ${response.status}`);\n    }\n\n    const data = await response.json();\n    return data.client_secret?.value || data.token;\n  }\n\n  private async setupLocalMedia(): Promise<MediaStream> {\n    try {\n      const constraints: MediaStreamConstraints = {\n        audio: this.config.audioConstraints || {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 24000\n        },\n        video: false\n      };\n\n      return await navigator.mediaDevices.getUserMedia(constraints);\n    } catch (error) {\n      throw new Error(`Failed to get user media: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  private async completeNegotiation(): Promise<void> {\n    if (!this.peerConnection || !this.ephemeralToken) {\n      console.log('[WebRTC] Missing peer connection or token');\n      return;\n    }\n\n    console.log('[WebRTC] Creating offer...');\n    // Create offer\n    const offer = await this.peerConnection.createOffer({\n      offerToReceiveAudio: true,\n      offerToReceiveVideo: false\n    });\n    await this.peerConnection.setLocalDescription(offer);\n\n    // Send offer to OpenAI\n    const baseUrl = 'https://api.openai.com';\n    const model = this.config.model || 'gpt-4o-realtime-preview-2024-12-17';\n    const url = `${baseUrl}/v1/realtime?model=${model}`;\n    \n    console.log('[WebRTC] Sending offer to:', url);\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/sdp',\n        'Authorization': `Bearer ${this.ephemeralToken}`,\n        'OpenAI-Beta': 'realtime=v1'\n      },\n      body: offer.sdp\n    });\n\n    if (!response.ok) {\n      const text = await response.text();\n      console.error('[WebRTC] Failed response:', response.status, text);\n      throw new Error(`Failed to get answer: ${response.status} - ${text}`);\n    }\n\n    console.log('[WebRTC] Got answer from OpenAI');\n    const answerSdp = await response.text();\n    const answer: RTCSessionDescriptionInit = {\n      type: 'answer',\n      sdp: answerSdp\n    };\n\n    await this.peerConnection.setRemoteDescription(answer);\n    console.log('[WebRTC] Remote description set successfully');\n  }\n\n  private setupPeerConnectionHandlers(): void {\n    if (!this.peerConnection) return;\n\n    this.peerConnection.onconnectionstatechange = () => {\n      const state = this.peerConnection?.connectionState;\n      \n      if (state === 'connected') {\n        this.emit('connected');\n      } else if (state === 'failed') {\n        this.emit('connectionFailed', new Error('WebRTC connection failed'));\n      } else if (state === 'disconnected' || state === 'closed') {\n        this.emit('disconnected', 'Connection closed');\n      }\n\n      this.emit('connectionStateChanged', this.getConnectionState());\n    };\n\n    this.peerConnection.ontrack = (event) => {\n      if (event.track) {\n        this.emit('audioTrackReceived', event.track);\n      }\n    };\n\n    this.peerConnection.ondatachannel = (event) => {\n      this.setupDataChannelHandlers(event.channel);\n    };\n  }\n\n  private setupDataChannelHandlers(channel?: RTCDataChannel): void {\n    const dc = channel || this.dataChannel;\n    if (!dc) return;\n\n    dc.onopen = () => {\n      console.log('[WebRTC] Data channel opened');\n      this.emit('dataChannelReady');\n      this.emit('connectionStateChanged', this.getConnectionState());\n    };\n\n    dc.onclose = () => {\n      console.log('[WebRTC] Data channel closed');\n      this.emit('connectionStateChanged', this.getConnectionState());\n    };\n\n    dc.onerror = (error) => {\n      console.error('[WebRTC] Data channel error:', error);\n      this.emit('connectionFailed', new Error(`Data channel error: ${error}`));\n    };\n\n    dc.onmessage = (event) => {\n      this.emit('dataChannelMessage', event.data);\n    };\n  }\n\n  private cleanup(): void {\n    if (this.localStream) {\n      this.localStream.getTracks().forEach(track => track.stop());\n      this.localStream = null;\n    }\n\n    if (this.dataChannel) {\n      this.dataChannel.close();\n      this.dataChannel = null;\n    }\n\n    if (this.peerConnection) {\n      this.peerConnection.close();\n      this.peerConnection = null;\n    }\n\n    this.ephemeralToken = null;\n  }\n\n  private log(message: string, ...args: any[]): void {\n    if (this.config.debug) {\n      console.log(`[WebRTCManager] ${message}`, ...args);\n    }\n  }\n}\n\nexport default WebRTCManager;","/**\n * OpenAI Realtime Service - Simple Version\n * \n * A straightforward service for OpenAI Realtime API with WebRTC.\n * No over-engineering, just the essentials.\n */\n\nimport { EventEmitter } from 'eventemitter3';\nimport { WebRTCManager, type WebRTCConfig } from './WebRTCManager';\nimport type { RealtimeVoice, AudioFormat } from '../types';\n\n// Simple types without complexity\ntype Modality = 'text' | 'audio';\n\nexport interface RealtimeServiceConfig extends WebRTCConfig {\n  tokenEndpoint?: string;\n  model?: string;\n  instructions?: string;\n  voice?: RealtimeVoice;\n  modalities?: Modality[];\n  temperature?: number;\n  maxOutputTokens?: number | 'inf';\n  inputAudioFormat?: AudioFormat;\n  outputAudioFormat?: AudioFormat;\n  turnDetection?: {\n    type: 'server_vad';\n    threshold?: number;\n    prefix_padding_ms?: number;\n    silence_duration_ms?: number;\n  };\n}\n\nexport interface RealtimeServiceState {\n  status: 'disconnected' | 'connecting' | 'connected' | 'error';\n  error?: Error;\n  messages: Array<{\n    id: string;\n    role: 'user' | 'assistant';\n    text?: string;\n    timestamp: number;\n  }>;\n}\n\nexport interface RealtimeServiceEvents {\n  connected: () => void;\n  disconnected: () => void;\n  error: (error: Error) => void;\n  textReceived: (text: string) => void;\n  audioReceived: (audio: ArrayBuffer) => void;\n  transcriptionReceived: (text: string) => void;\n  statusChanged: (status: RealtimeServiceState['status']) => void;\n}\n\n/**\n * Simple OpenAI Realtime Service\n */\nexport class OpenAIRealtimeService extends EventEmitter<RealtimeServiceEvents> {\n  private webrtcManager: WebRTCManager;\n  private config: RealtimeServiceConfig;\n  public state: RealtimeServiceState;\n  private events: any; // Compatible with local service events\n  private audioElement: HTMLAudioElement | null = null;\n  private isDisposed = false;\n\n  constructor(config: RealtimeServiceConfig, events: any = {}) {\n    super();\n    \n    this.config = {\n      tokenEndpoint: '/api/session',\n      model: 'gpt-4o-realtime-preview-2024-12-17',\n      voice: 'alloy',\n      modalities: ['text', 'audio'],\n      temperature: 0.8,\n      maxOutputTokens: 4096,\n      inputAudioFormat: 'pcm16',\n      outputAudioFormat: 'pcm16',\n      turnDetection: {\n        type: 'server_vad',\n        threshold: 0.5,\n        prefix_padding_ms: 300,\n        silence_duration_ms: 500\n      },\n      ...config\n    };\n    this.events = events;\n\n    this.state = {\n      status: 'disconnected',\n      messages: []\n    };\n\n    this.webrtcManager = new WebRTCManager(this.config);\n    this.setupWebRTCHandlers();\n  }\n\n  /**\n   * Connect to OpenAI Realtime\n   */\n  async connect(audioElement?: HTMLAudioElement): Promise<void> {\n    if (this.isDisposed) {\n      throw new Error('Service has been disposed');\n    }\n\n    if (this.state.status === 'connected' || this.state.status === 'connecting') {\n      return;\n    }\n\n    try {\n      this.updateStatus('connecting');\n      \n      // Store audio element for playback\n      this.audioElement = audioElement || null;\n      \n      this.log('Initializing WebRTC...');\n      await this.webrtcManager.initialize();\n      \n      // OpenAI's example doesn't wait or send config - just mark as connected\n      this.updateStatus('connected');\n      this.emit('connected');\n      this.events.onConnect?.();\n      this.log('Connected successfully');\n      \n      // Try to send session config after a delay (optional enhancement)\n      setTimeout(() => {\n        if (this.webrtcManager.isDataChannelOpen()) {\n          this.sendSessionConfig().catch(err => {\n            this.log('Session config failed (non-critical):', err);\n          });\n        }\n      }, 1000);\n    } catch (error) {\n      this.updateStatus('error');\n      this.state.error = error instanceof Error ? error : new Error('Unknown error');\n      this.emit('error', this.state.error);\n      throw error;\n    }\n  }\n\n  /**\n   * Update instructions\n   */\n  async updateInstructions(instructions: string): Promise<void> {\n    this.config.instructions = instructions;\n    \n    if (this.state.status === 'connected') {\n      // Send updated session config\n      await this.sendSessionConfig();\n    }\n  }\n\n  /**\n   * Send text message\n   */\n  async sendText(text: string): Promise<void> {\n    if (this.state.status !== 'connected') {\n      throw new Error('Not connected');\n    }\n\n    const message = {\n      type: 'conversation.item.create',\n      item: {\n        type: 'message',\n        role: 'user',\n        content: [{\n          type: 'input_text',\n          text\n        }]\n      }\n    };\n\n    this.webrtcManager.sendData(JSON.stringify(message));\n    this.webrtcManager.sendData(JSON.stringify({ type: 'response.create' }));\n\n    // Add to messages\n    this.state.messages.push({\n      id: `msg-${Date.now()}`,\n      role: 'user',\n      text,\n      timestamp: Date.now()\n    });\n  }\n\n  /**\n   * Disconnect from OpenAI Realtime\n   */\n  async disconnect(): Promise<void> {\n    if (this.state.status === 'disconnected') {\n      return;\n    }\n\n    await this.webrtcManager.close();\n    \n    // Clean up audio element\n    if (this.audioElement) {\n      this.audioElement.srcObject = null;\n    }\n    \n    this.updateStatus('disconnected');\n    this.emit('disconnected');\n    this.events.onDisconnect?.();\n  }\n\n  /**\n   * Dispose the service\n   */\n  dispose(): void {\n    if (this.isDisposed) return;\n    \n    this.isDisposed = true;\n    this.webrtcManager.dispose();\n    this.removeAllListeners();\n    this.updateStatus('disconnected');\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(config: Partial<RealtimeServiceConfig>): void {\n    Object.assign(this.config, config);\n    \n    if (this.state.status === 'connected') {\n      this.sendSessionConfig().catch(error => {\n        this.emit('error', error);\n      });\n    }\n  }\n\n  // Private methods\n\n  private setupWebRTCHandlers(): void {\n    this.webrtcManager.on('connected', () => {\n      this.log('WebRTC connected');\n    });\n\n    this.webrtcManager.on('disconnected', (reason) => {\n      this.log('WebRTC disconnected:', reason);\n      this.updateStatus('disconnected');\n      this.emit('disconnected');\n      this.events.onDisconnect?.();\n    });\n\n    this.webrtcManager.on('connectionFailed', (error) => {\n      this.log('WebRTC connection failed:', error);\n      this.updateStatus('error');\n      this.state.error = error;\n      this.emit('error', error);\n      this.events.onError?.(error);\n    });\n\n    this.webrtcManager.on('dataChannelMessage', (data) => {\n      this.handleDataChannelMessage(data);\n    });\n\n    this.webrtcManager.on('audioTrackReceived', (track) => {\n      this.log('Audio track received');\n      if (this.audioElement && track.kind === 'audio') {\n        const stream = new MediaStream([track]);\n        this.audioElement.srcObject = stream;\n        this.log('Audio stream connected to element');\n      }\n    });\n  }\n\n  private handleDataChannelMessage(data: string | ArrayBuffer): void {\n    if (typeof data !== 'string') return;\n\n    try {\n      const message = JSON.parse(data);\n      \n      switch (message.type) {\n        case 'conversation.item.created':\n          if (message.item?.role === 'assistant' && message.item?.content) {\n            const textContent = message.item.content.find((c: any) => c.type === 'text');\n            if (textContent?.text) {\n              this.emit('textReceived', textContent.text);\n              this.events.onTranscript?.('assistant', textContent.text);\n              this.state.messages.push({\n                id: message.item.id || `msg-${Date.now()}`,\n                role: 'assistant',\n                text: textContent.text,\n                timestamp: Date.now()\n              });\n            }\n          }\n          break;\n\n        case 'conversation.item.input_audio_transcription.completed':\n          if (message.transcript) {\n            this.emit('transcriptionReceived', message.transcript);\n            this.events.onTranscript?.('user', message.transcript);\n          }\n          break;\n\n        case 'response.audio.delta':\n          if (message.delta) {\n            const audioData = Uint8Array.from(atob(message.delta), c => c.charCodeAt(0));\n            this.emit('audioReceived', audioData.buffer);\n          }\n          break;\n\n        case 'error':\n          this.emit('error', new Error(message.error?.message || 'Unknown error'));\n          break;\n      }\n    } catch (error) {\n      this.log('Failed to handle message:', error);\n    }\n  }\n\n  private async waitForDataChannel(timeout = 10000): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const timer = setTimeout(() => {\n        this.webrtcManager.off('dataChannelReady', onReady);\n        reject(new Error('Data channel failed to open'));\n      }, timeout);\n\n      const onReady = () => {\n        clearTimeout(timer);\n        resolve();\n      };\n\n      // Check if already open\n      if (this.webrtcManager.isDataChannelOpen()) {\n        clearTimeout(timer);\n        resolve();\n        return;\n      }\n\n      // Wait for it to open\n      this.webrtcManager.once('dataChannelReady', onReady);\n    });\n  }\n\n  private async sendSessionConfig(): Promise<void> {\n    const sessionUpdate = {\n      type: 'session.update',\n      session: {\n        model: this.config.model,\n        modalities: this.config.modalities,\n        instructions: this.config.instructions,\n        voice: this.config.voice,\n        input_audio_format: this.config.inputAudioFormat,\n        output_audio_format: this.config.outputAudioFormat,\n        input_audio_transcription: this.config.inputAudioFormat ? {\n          model: 'whisper-1'\n        } : null,\n        turn_detection: this.config.turnDetection,\n        temperature: this.config.temperature,\n        max_output_tokens: this.config.maxOutputTokens === 'inf' ? null : this.config.maxOutputTokens\n      }\n    };\n\n    this.webrtcManager.sendData(JSON.stringify(sessionUpdate));\n  }\n\n  private updateStatus(status: RealtimeServiceState['status']): void {\n    if (this.state.status !== status) {\n      this.state.status = status;\n      this.emit('statusChanged', status);\n      this.events.onStatusUpdate?.(status);\n    }\n  }\n\n  private log(message: string, ...args: any[]): void {\n    if (this.config.debug) {\n      console.log(`[OpenAIRealtime] ${message}`, ...args);\n    }\n  }\n}\n\nexport default OpenAIRealtimeService;","/**\n * Simple constants for OpenAI Realtime WebRTC\n */\n\n// Model and API\nexport const DEFAULT_OPENAI_MODEL = 'gpt-4o-realtime-preview-2024-12-17';\nexport const OPENAI_DATA_CHANNEL_NAME = 'oai-events';\n\n// Audio settings\nexport const DEFAULT_SAMPLE_RATE = 24000;\nexport const DEFAULT_CHANNEL_COUNT = 1;\n\n// Basic error messages\nexport const ERROR_MESSAGES = {\n  DISPOSED: 'Manager has been disposed',\n  ALREADY_INITIALIZED: 'Connection already initialized',\n  NOT_INITIALIZED: 'Connection not initialized',\n  NOT_CONNECTED: 'Service not connected',\n  DATA_CHANNEL_UNAVAILABLE: 'Data channel not available',\n  TOKEN_ENDPOINT_MISSING: 'Token endpoint not configured',\n  PERMISSION_DENIED: 'Microphone permission denied',\n  DEVICE_NOT_FOUND: 'No audio input device found'\n} as const;","/**\n * Simple error classes for OpenAI Realtime WebRTC\n */\n\n/**\n * Base error class\n */\nexport class RealtimeError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'RealtimeError';\n  }\n}\n\n/**\n * WebRTC connection error\n */\nexport class WebRTCError extends RealtimeError {\n  constructor(message: string) {\n    super(message);\n    this.name = 'WebRTCError';\n  }\n}\n\n/**\n * Audio permission error\n */\nexport class AudioError extends RealtimeError {\n  constructor(message: string) {\n    super(message);\n    this.name = 'AudioError';\n  }\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,CAAA,IAAI,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,cAAA;KACvB,MAAM,GAAG,GAAG,CAAA;;AAEhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,SAAS,MAAM,GAAG,EAAA;;AAElB;AACA;AACA;AACA;AACA;AACA;AACA;CACA,IAAI,MAAM,CAAC,MAAM,EAAE;GACjB,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;;AAExC;AACA;AACA;AACA;GACE,IAAI,CAAC,IAAI,MAAM,EAAE,CAAC,SAAS,EAAE,MAAM,GAAG,KAAK,CAAA;AAC7C,EAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,SAAS,EAAE,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;AAC/B,GAAE,IAAI,CAAC,EAAE,GAAG,EAAE,CAAA;AACd,GAAE,IAAI,CAAC,OAAO,GAAG,OAAO,CAAA;AACxB,GAAE,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,KAAK,CAAA;AAC3B,EAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;CACA,SAAS,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;AACxD,GAAE,IAAI,OAAO,EAAE,KAAK,UAAU,EAAE;AAChC,KAAI,MAAM,IAAI,SAAS,CAAC,iCAAiC,CAAC,CAAA;AAC1D,IAAA;;AAEA,GAAE,IAAI,QAAQ,GAAG,IAAI,EAAE,CAAC,EAAE,EAAE,OAAO,IAAI,OAAO,EAAE,IAAI,CAAA;OAC9C,GAAG,GAAG,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,KAAK,CAAA;;GAEzC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,QAAQ,EAAE,OAAO,CAAC,YAAY,EAAE,CAAA;QAC7E,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;AACxE,QAAO,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,QAAQ,CAAC,CAAA;;AAE9D,GAAE,OAAO,OAAO,CAAA;AAChB,EAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,SAAS,UAAU,CAAC,OAAO,EAAE,GAAG,EAAE;AAClC,GAAE,IAAI,EAAE,OAAO,CAAC,YAAY,KAAK,CAAC,EAAE,OAAO,CAAC,OAAO,GAAG,IAAI,MAAM,EAAE,CAAA;AAClE,QAAO,OAAO,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;AAClC,EAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,SAAS,YAAY,GAAG;AACxB,GAAE,IAAI,CAAC,OAAO,GAAG,IAAI,MAAM,EAAE,CAAA;AAC7B,GAAE,IAAI,CAAC,YAAY,GAAG,CAAC,CAAA;AACvB,EAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,YAAY,CAAC,SAAS,CAAC,UAAU,GAAG,SAAS,UAAU,GAAG;GACxD,IAAI,KAAK,GAAG,EAAA;OACR,MAAA;AACN,OAAM,IAAI,CAAA;;GAER,IAAI,IAAI,CAAC,YAAY,KAAK,CAAC,EAAE,OAAO,KAAK,CAAA;;GAEzC,KAAK,IAAI,KAAK,MAAM,GAAG,IAAI,CAAC,OAAO,GAAG;KACpC,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAA;AACzE,IAAA;;AAEA,GAAE,IAAI,MAAM,CAAC,qBAAqB,EAAE;KAChC,OAAO,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC,CAAA;AAC7D,IAAA;;AAEA,GAAE,OAAO,KAAK,CAAA;EACb,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;CACA,YAAY,CAAC,SAAS,CAAC,SAAS,GAAG,SAAS,SAAS,CAAC,KAAK,EAAE;GAC3D,IAAI,GAAG,GAAG,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,KAAA;AACtC,OAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;;AAElC,GAAE,IAAI,CAAC,QAAQ,EAAE,OAAO,EAAE,CAAA;GACxB,IAAI,QAAQ,CAAC,EAAE,EAAE,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAA;;GAErC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;KAClE,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAA;AAC1B,IAAA;;AAEA,GAAE,OAAO,EAAE,CAAA;EACV,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;CACA,YAAY,CAAC,SAAS,CAAC,aAAa,GAAG,SAAS,aAAa,CAAC,KAAK,EAAE;GACnE,IAAI,GAAG,GAAG,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,KAAA;AACtC,OAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;;AAEnC,GAAE,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC,CAAA;AAC1B,GAAE,IAAI,SAAS,CAAC,EAAE,EAAE,OAAO,CAAC,CAAA;GAC1B,OAAO,SAAS,CAAC,MAAM,CAAA;EACxB,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,YAAY,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,IAAI,CAAC,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE;GACrE,IAAI,GAAG,GAAG,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,KAAK,CAAA;;GAEzC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,OAAO,KAAK,CAAA;;AAEtC,GAAE,IAAI,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAA;OAC5B,GAAG,GAAG,SAAS,CAAC,MAAA;OAChB,IAAA;AACN,OAAM,CAAC,CAAA;;AAEP,GAAE,IAAI,SAAS,CAAC,EAAE,EAAE;AACpB,KAAI,IAAI,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,SAAS,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,CAAC,CAAA;;AAEjF,KAAI,QAAQ,GAAG;AACf,OAAM,KAAK,CAAC,EAAE,OAAO,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,IAAI,CAAA;AAC/D,OAAM,KAAK,CAAC,EAAE,OAAO,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,EAAE,CAAC,EAAE,IAAI,CAAA;AACnE,OAAM,KAAK,CAAC,EAAE,OAAO,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,CAAA;OACjE,KAAK,CAAC,EAAE,OAAO,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,CAAA;OACrE,KAAK,CAAC,EAAE,OAAO,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,CAAA;OACzE,KAAK,CAAC,EAAE,OAAO,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,CAAA;AACnF,MAAA;;KAEI,KAAK,CAAC,GAAG,CAAC,EAAE,IAAI,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;OAClD,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAA;AAChC,MAAA;;KAEI,SAAS,CAAC,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;AAC/C,IAAG,MAAM;AACT,KAAI,IAAI,MAAM,GAAG,SAAS,CAAC,MAAA;AAC3B,SAAQ,CAAC,CAAA;;KAEL,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;OAC3B,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,SAAS,EAAE,IAAI,CAAC,CAAA;;AAEzF,OAAM,QAAQ,GAAG;SACT,KAAK,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,MAAA;SACpD,KAAK,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,CAAC,MAAA;SACxD,KAAK,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,MAAA;SAC5D,KAAK,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,MAAA;SAChE;WACE,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,GAAG,CAAC,EAAE,IAAI,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;aAC7D,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAA;AACtC,YAAA;;AAEA,WAAU,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;AAC3D,QAAA;AACA,MAAA;AACA,IAAA;;AAEA,GAAE,OAAO,IAAI,CAAA;EACZ,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,YAAY,CAAC,SAAS,CAAC,EAAE,GAAG,SAAS,EAAE,CAAC,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE;AAC5D,GAAE,OAAO,WAAW,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,CAAC,CAAA;EACpD,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,YAAY,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,IAAI,CAAC,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE;AAChE,GAAE,OAAO,WAAW,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,CAAA;EACnD,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAA,YAAY,CAAC,SAAS,CAAC,cAAc,GAAG,SAAS,cAAc,CAAC,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;GACxF,IAAI,GAAG,GAAG,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,KAAK,CAAA;;GAEzC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,OAAO,IAAI,CAAA;GACnC,IAAI,CAAC,EAAE,EAAE;AACX,KAAI,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AACzB,KAAI,OAAO,IAAI,CAAA;AACf,IAAA;;GAEE,IAAI,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;;AAEnC,GAAE,IAAI,SAAS,CAAC,EAAE,EAAE;KAChB;AACJ,OAAM,SAAS,CAAC,EAAE,KAAK,EAAE;AACzB,QAAO,CAAC,IAAI,IAAI,SAAS,CAAC,IAAI,CAAC;AAC/B,QAAO,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,KAAK,OAAO,CAAA;OAC1C;AACN,OAAM,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AAC3B,MAAA;AACA,IAAG,MAAM;KACL,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,MAAM,GAAG,EAAE,EAAE,MAAM,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;OACvE;AACN,SAAQ,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE;UACrB,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;UAC3B,OAAO,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,OAAO,CAAA;SAC5C;SACA,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAA;AACjC,QAAA;AACA,MAAA;;AAEA;AACA;AACA;KACI,IAAI,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,MAAM,KAAK,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAA;AACnF,UAAS,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AAC9B,IAAA;;AAEA,GAAE,OAAO,IAAI,CAAA;EACZ,CAAA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;CACA,YAAY,CAAC,SAAS,CAAC,kBAAkB,GAAG,SAAS,kBAAkB,CAAC,KAAK,EAAE;AAC/E,GAAE,IAAI,GAAG,CAAA;;GAEP,IAAI,KAAK,EAAE;KACT,GAAG,GAAG,MAAM,GAAG,MAAM,GAAG,KAAK,GAAG,KAAK,CAAA;AACzC,KAAI,IAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;AAChD,IAAG,MAAM;AACT,KAAI,IAAI,CAAC,OAAO,GAAG,IAAI,MAAM,EAAE,CAAA;AAC/B,KAAI,IAAI,CAAC,YAAY,GAAG,CAAC,CAAA;AACzB,IAAA;;AAEA,GAAE,OAAO,IAAI,CAAA;EACZ,CAAA;;AAED;AACA;AACA;CACA,YAAY,CAAC,SAAS,CAAC,GAAG,GAAG,YAAY,CAAC,SAAS,CAAC,cAAc,CAAA;CAClE,YAAY,CAAC,SAAS,CAAC,WAAW,GAAG,YAAY,CAAC,SAAS,CAAC,EAAE,CAAA;;AAE9D;AACA;AACA;CACA,YAAY,CAAC,QAAQ,GAAG,MAAM,CAAA;;AAE9B;AACA;AACA;CACA,YAAY,CAAC,YAAY,GAAG,YAAY,CAAA;;AAExC;AACA;AACA;CACmC;AACnC,GAAE,iBAAiB,YAAY,CAAA;AAC/B,EAAA;;;;;;AC1SM,MAAO,aAAc,SAAQ,YAA0B,CAAA;AAO3D,IAAA,WAAA,CAAY,SAAuB,EAAE,EAAA;AACnC,QAAA,KAAK,EAAE,CAAC;QAPF,IAAc,CAAA,cAAA,GAA6B,IAAI,CAAC;QAChD,IAAW,CAAA,WAAA,GAA0B,IAAI,CAAC;QAC1C,IAAW,CAAA,WAAA,GAAuB,IAAI,CAAC;QAEvC,IAAc,CAAA,cAAA,GAAkB,IAAI,CAAC;QAI3C,IAAI,CAAC,MAAM,GACT,MAAA,CAAA,MAAA,CAAA,EAAA,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,8BAA8B,EAAE,CAAC,EACtD,KAAK,EAAE,oCAAoC,EAC3C,KAAK,EAAE,KAAK,EAAA,EACT,MAAM,CACV,CAAC;KACH;IAKK,UAAU,GAAA;;AACd,YAAA,IAAI,IAAI,CAAC,cAAc,EAAE;AACvB,gBAAA,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;aAC/C;AAED,YAAA,IAAI;AACF,gBAAA,OAAO,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC;AAEnD,gBAAA,IAAI,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE;oBAC7B,OAAO,CAAC,GAAG,CAAC,wCAAwC,EAAE,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;oBACjF,IAAI,CAAC,cAAc,GAAG,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;AACrD,oBAAA,OAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;iBAC7C;qBAAM;AACL,oBAAA,OAAO,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC;iBACpD;AAGD,gBAAA,OAAO,CAAC,GAAG,CAAC,sCAAsC,CAAC,CAAC;AACpD,gBAAA,IAAI,CAAC,cAAc,GAAG,IAAI,iBAAiB,CAAC;AAC1C,oBAAA,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU;AACnC,iBAAA,CAAC,CAAC;gBACH,IAAI,CAAC,2BAA2B,EAAE,CAAC;AAGnC,gBAAA,OAAO,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;gBACjD,IAAI,CAAC,WAAW,GAAG,MAAM,IAAI,CAAC,eAAe,EAAE,CAAC;AAChD,gBAAA,IAAI,IAAI,CAAC,WAAW,EAAE;oBACpB,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,CAAC;oBACxD,IAAI,UAAU,EAAE;wBACd,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;AAC3D,wBAAA,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;qBAC3C;iBACF;AAGD,gBAAA,OAAO,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;gBACjD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,YAAY,EAAE;AACrE,oBAAA,OAAO,EAAE,IAAI;AACd,iBAAA,CAAC,CAAC;gBACH,IAAI,CAAC,wBAAwB,EAAE,CAAC;AAGhC,gBAAA,IAAI,IAAI,CAAC,cAAc,EAAE;AACvB,oBAAA,OAAO,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAC;AAChD,oBAAA,MAAM,IAAI,CAAC,mBAAmB,EAAE,CAAC;iBAClC;qBAAM;AACL,oBAAA,OAAO,CAAC,GAAG,CAAC,mDAAmD,CAAC,CAAC;iBAClE;aACF;YAAC,OAAO,KAAK,EAAE;gBACd,IAAI,CAAC,OAAO,EAAE,CAAC;AACf,gBAAA,MAAM,IAAI,KAAK,CAAC,gCAAgC,KAAK,YAAY,KAAK,GAAG,KAAK,CAAC,OAAO,GAAG,eAAe,CAAA,CAAE,CAAC,CAAC;aAC7G;SACF,CAAA,CAAA;AAAA,KAAA;AAKD,IAAA,QAAQ,CAAC,IAA0B,EAAA;AACjC,QAAA,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,UAAU,KAAK,MAAM,EAAE;AAC/D,YAAA,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;SAC/C;AAGD,QAAA,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;AAC5B,YAAA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC7B;aAAM;YAEL,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;SAC7C;KACF;IAKD,WAAW,GAAA;;QACT,OAAO,CAAA,MAAA,IAAI,CAAC,cAAc,MAAE,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,eAAe,MAAK,WAAW,CAAC;KAC7D;IAKD,iBAAiB,GAAA;;QACf,OAAO,CAAA,MAAA,IAAI,CAAC,WAAW,MAAE,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,UAAU,MAAK,MAAM,CAAC;KAChD;IAKD,kBAAkB,GAAA;;QAChB,OAAO;YACL,eAAe,EAAE,CAAA,CAAA,EAAA,GAAA,IAAI,CAAC,cAAc,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,eAAe,KAAI,KAAK;YAC9D,kBAAkB,EAAE,CAAA,CAAA,EAAA,GAAA,IAAI,CAAC,cAAc,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,kBAAkB,KAAI,KAAK;YACpE,gBAAgB,EAAE,CAAA,CAAA,EAAA,GAAA,IAAI,CAAC,WAAW,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,UAAU,KAAI,IAAI;AACtD,YAAA,gBAAgB,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW;SACrC,CAAC;KACH;IAKK,KAAK,GAAA;;YACT,IAAI,CAAC,OAAO,EAAE,CAAC;AACf,YAAA,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SAC3B,CAAA,CAAA;AAAA,KAAA;IAKD,OAAO,GAAA;QACL,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,kBAAkB,EAAE,CAAC;KAC3B;IAIa,iBAAiB,GAAA;;;AAC7B,YAAA,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE;AAC9B,gBAAA,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;aAClD;YAED,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE;AACtD,gBAAA,MAAM,EAAE,MAAM;AACd,gBAAA,OAAO,EAAE,EAAE,cAAc,EAAE,kBAAkB,EAAE;AAChD,aAAA,CAAC,CAAC;AACH,YAAA,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE;gBAChB,MAAM,IAAI,KAAK,CAAC,CAAA,qBAAA,EAAwB,QAAQ,CAAC,MAAM,CAAE,CAAA,CAAC,CAAC;aAC5D;AAED,YAAA,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;YACnC,OAAO,CAAA,CAAA,EAAA,GAAA,IAAI,CAAC,aAAa,MAAE,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,KAAK,KAAI,IAAI,CAAC,KAAK,CAAC;SAChD,CAAA,CAAA;AAAA,KAAA;IAEa,eAAe,GAAA;;AAC3B,YAAA,IAAI;AACF,gBAAA,MAAM,WAAW,GAA2B;AAC1C,oBAAA,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB,IAAI;AACrC,wBAAA,gBAAgB,EAAE,IAAI;AACtB,wBAAA,gBAAgB,EAAE,IAAI;AACtB,wBAAA,eAAe,EAAE,IAAI;AACrB,wBAAA,UAAU,EAAE,KAAK;AAClB,qBAAA;AACD,oBAAA,KAAK,EAAE,KAAK;iBACb,CAAC;gBAEF,OAAO,MAAM,SAAS,CAAC,YAAY,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;aAC/D;YAAC,OAAO,KAAK,EAAE;AACd,gBAAA,MAAM,IAAI,KAAK,CAAC,6BAA6B,KAAK,YAAY,KAAK,GAAG,KAAK,CAAC,OAAO,GAAG,eAAe,CAAA,CAAE,CAAC,CAAC;aAC1G;SACF,CAAA,CAAA;AAAA,KAAA;IAEa,mBAAmB,GAAA;;YAC/B,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;AAChD,gBAAA,OAAO,CAAC,GAAG,CAAC,2CAA2C,CAAC,CAAC;gBACzD,OAAO;aACR;AAED,YAAA,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;YAE1C,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC;AAClD,gBAAA,mBAAmB,EAAE,IAAI;AACzB,gBAAA,mBAAmB,EAAE,KAAK;AAC3B,aAAA,CAAC,CAAC;YACH,MAAM,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;YAGrD,MAAM,OAAO,GAAG,wBAAwB,CAAC;YACzC,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,oCAAoC,CAAC;AACxE,YAAA,MAAM,GAAG,GAAG,CAAA,EAAG,OAAO,CAAsB,mBAAA,EAAA,KAAK,EAAE,CAAC;AAEpD,YAAA,OAAO,CAAC,GAAG,CAAC,4BAA4B,EAAE,GAAG,CAAC,CAAC;AAC/C,YAAA,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,GAAG,EAAE;AAChC,gBAAA,MAAM,EAAE,MAAM;AACd,gBAAA,OAAO,EAAE;AACP,oBAAA,cAAc,EAAE,iBAAiB;AACjC,oBAAA,eAAe,EAAE,CAAA,OAAA,EAAU,IAAI,CAAC,cAAc,CAAE,CAAA;AAChD,oBAAA,aAAa,EAAE,aAAa;AAC7B,iBAAA;gBACD,IAAI,EAAE,KAAK,CAAC,GAAG;AAChB,aAAA,CAAC,CAAC;AAEH,YAAA,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE;AAChB,gBAAA,MAAM,IAAI,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;gBACnC,OAAO,CAAC,KAAK,CAAC,2BAA2B,EAAE,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;gBAClE,MAAM,IAAI,KAAK,CAAC,CAAyB,sBAAA,EAAA,QAAQ,CAAC,MAAM,CAAM,GAAA,EAAA,IAAI,CAAE,CAAA,CAAC,CAAC;aACvE;AAED,YAAA,OAAO,CAAC,GAAG,CAAC,iCAAiC,CAAC,CAAC;AAC/C,YAAA,MAAM,SAAS,GAAG,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;AACxC,YAAA,MAAM,MAAM,GAA8B;AACxC,gBAAA,IAAI,EAAE,QAAQ;AACd,gBAAA,GAAG,EAAE,SAAS;aACf,CAAC;YAEF,MAAM,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;AACvD,YAAA,OAAO,CAAC,GAAG,CAAC,8CAA8C,CAAC,CAAC;SAC7D,CAAA,CAAA;AAAA,KAAA;IAEO,2BAA2B,GAAA;QACjC,IAAI,CAAC,IAAI,CAAC,cAAc;YAAE,OAAO;AAEjC,QAAA,IAAI,CAAC,cAAc,CAAC,uBAAuB,GAAG,MAAK;;YACjD,MAAM,KAAK,GAAG,CAAA,EAAA,GAAA,IAAI,CAAC,cAAc,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,eAAe,CAAC;AAEnD,YAAA,IAAI,KAAK,KAAK,WAAW,EAAE;AACzB,gBAAA,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;aACxB;AAAM,iBAAA,IAAI,KAAK,KAAK,QAAQ,EAAE;gBAC7B,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC,CAAC;aACtE;iBAAM,IAAI,KAAK,KAAK,cAAc,IAAI,KAAK,KAAK,QAAQ,EAAE;AACzD,gBAAA,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,mBAAmB,CAAC,CAAC;aAChD;YAED,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;AACjE,SAAC,CAAC;QAEF,IAAI,CAAC,cAAc,CAAC,OAAO,GAAG,CAAC,KAAK,KAAI;AACtC,YAAA,IAAI,KAAK,CAAC,KAAK,EAAE;gBACf,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;aAC9C;AACH,SAAC,CAAC;QAEF,IAAI,CAAC,cAAc,CAAC,aAAa,GAAG,CAAC,KAAK,KAAI;AAC5C,YAAA,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AAC/C,SAAC,CAAC;KACH;AAEO,IAAA,wBAAwB,CAAC,OAAwB,EAAA;AACvD,QAAA,MAAM,EAAE,GAAG,OAAO,IAAI,IAAI,CAAC,WAAW,CAAC;AACvC,QAAA,IAAI,CAAC,EAAE;YAAE,OAAO;AAEhB,QAAA,EAAE,CAAC,MAAM,GAAG,MAAK;AACf,YAAA,OAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;AAC5C,YAAA,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC9B,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;AACjE,SAAC,CAAC;AAEF,QAAA,EAAE,CAAC,OAAO,GAAG,MAAK;AAChB,YAAA,OAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;YAC5C,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;AACjE,SAAC,CAAC;AAEF,QAAA,EAAE,CAAC,OAAO,GAAG,CAAC,KAAK,KAAI;AACrB,YAAA,OAAO,CAAC,KAAK,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;AACrD,YAAA,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,IAAI,KAAK,CAAC,CAAuB,oBAAA,EAAA,KAAK,CAAE,CAAA,CAAC,CAAC,CAAC;AAC3E,SAAC,CAAC;AAEF,QAAA,EAAE,CAAC,SAAS,GAAG,CAAC,KAAK,KAAI;YACvB,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;AAC9C,SAAC,CAAC;KACH;IAEO,OAAO,GAAA;AACb,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;AACpB,YAAA,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,KAAK,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC;AAC5D,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;AAED,QAAA,IAAI,IAAI,CAAC,WAAW,EAAE;AACpB,YAAA,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;AACzB,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;AAED,QAAA,IAAI,IAAI,CAAC,cAAc,EAAE;AACvB,YAAA,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC;AAC5B,YAAA,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;SAC5B;AAED,QAAA,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;KAC5B;AAEO,IAAA,GAAG,CAAC,OAAe,EAAE,GAAG,IAAW,EAAA;AACzC,QAAA,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;YACrB,OAAO,CAAC,GAAG,CAAC,CAAmB,gBAAA,EAAA,OAAO,EAAE,EAAE,GAAG,IAAI,CAAC,CAAC;SACpD;KACF;AACF;;ACnRK,MAAO,qBAAsB,SAAQ,YAAmC,CAAA;IAQ5E,WAAY,CAAA,MAA6B,EAAE,MAAA,GAAc,EAAE,EAAA;AACzD,QAAA,KAAK,EAAE,CAAC;QAJF,IAAY,CAAA,YAAA,GAA4B,IAAI,CAAC;QAC7C,IAAU,CAAA,UAAA,GAAG,KAAK,CAAC;AAKzB,QAAA,IAAI,CAAC,MAAM,GAAA,MAAA,CAAA,MAAA,CAAA,EACT,aAAa,EAAE,cAAc,EAC7B,KAAK,EAAE,oCAAoC,EAC3C,KAAK,EAAE,OAAO,EACd,UAAU,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC,EAC7B,WAAW,EAAE,GAAG,EAChB,eAAe,EAAE,IAAI,EACrB,gBAAgB,EAAE,OAAO,EACzB,iBAAiB,EAAE,OAAO,EAC1B,aAAa,EAAE;AACb,gBAAA,IAAI,EAAE,YAAY;AAClB,gBAAA,SAAS,EAAE,GAAG;AACd,gBAAA,iBAAiB,EAAE,GAAG;AACtB,gBAAA,mBAAmB,EAAE,GAAG;aACzB,EACE,EAAA,MAAM,CACV,CAAC;AACF,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QAErB,IAAI,CAAC,KAAK,GAAG;AACX,YAAA,MAAM,EAAE,cAAc;AACtB,YAAA,QAAQ,EAAE,EAAE;SACb,CAAC;QAEF,IAAI,CAAC,aAAa,GAAG,IAAI,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACpD,IAAI,CAAC,mBAAmB,EAAE,CAAC;KAC5B;AAKK,IAAA,OAAO,CAAC,YAA+B,EAAA;;;AAC3C,YAAA,IAAI,IAAI,CAAC,UAAU,EAAE;AACnB,gBAAA,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;aAC9C;AAED,YAAA,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,WAAW,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,YAAY,EAAE;gBAC3E,OAAO;aACR;AAED,YAAA,IAAI;AACF,gBAAA,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;AAGhC,gBAAA,IAAI,CAAC,YAAY,GAAG,YAAY,IAAI,IAAI,CAAC;AAEzC,gBAAA,IAAI,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;AACnC,gBAAA,MAAM,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE,CAAC;AAGtC,gBAAA,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;AAC/B,gBAAA,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AACvB,gBAAA,CAAA,EAAA,GAAA,MAAA,IAAI,CAAC,MAAM,EAAC,SAAS,kDAAI,CAAC;AAC1B,gBAAA,IAAI,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;gBAGnC,UAAU,CAAC,MAAK;AACd,oBAAA,IAAI,IAAI,CAAC,aAAa,CAAC,iBAAiB,EAAE,EAAE;wBAC1C,IAAI,CAAC,iBAAiB,EAAE,CAAC,KAAK,CAAC,GAAG,IAAG;AACnC,4BAAA,IAAI,CAAC,GAAG,CAAC,uCAAuC,EAAE,GAAG,CAAC,CAAC;AACzD,yBAAC,CAAC,CAAC;qBACJ;iBACF,EAAE,IAAI,CAAC,CAAC;aACV;YAAC,OAAO,KAAK,EAAE;AACd,gBAAA,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;gBAC3B,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,YAAY,KAAK,GAAG,KAAK,GAAG,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;gBAC/E,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;AACrC,gBAAA,MAAM,KAAK,CAAC;aACb;SACF,CAAA,CAAA;AAAA,KAAA;AAKK,IAAA,kBAAkB,CAAC,YAAoB,EAAA;;AAC3C,YAAA,IAAI,CAAC,MAAM,CAAC,YAAY,GAAG,YAAY,CAAC;YAExC,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,WAAW,EAAE;AAErC,gBAAA,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAChC;SACF,CAAA,CAAA;AAAA,KAAA;AAKK,IAAA,QAAQ,CAAC,IAAY,EAAA;;YACzB,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,WAAW,EAAE;AACrC,gBAAA,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;aAClC;AAED,YAAA,MAAM,OAAO,GAAG;AACd,gBAAA,IAAI,EAAE,0BAA0B;AAChC,gBAAA,IAAI,EAAE;AACJ,oBAAA,IAAI,EAAE,SAAS;AACf,oBAAA,IAAI,EAAE,MAAM;AACZ,oBAAA,OAAO,EAAE,CAAC;AACR,4BAAA,IAAI,EAAE,YAAY;4BAClB,IAAI;yBACL,CAAC;AACH,iBAAA;aACF,CAAC;AAEF,YAAA,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;AACrD,YAAA,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,iBAAiB,EAAE,CAAC,CAAC,CAAC;AAGzE,YAAA,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;AACvB,gBAAA,EAAE,EAAE,CAAO,IAAA,EAAA,IAAI,CAAC,GAAG,EAAE,CAAE,CAAA;AACvB,gBAAA,IAAI,EAAE,MAAM;gBACZ,IAAI;AACJ,gBAAA,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;AACtB,aAAA,CAAC,CAAC;SACJ,CAAA,CAAA;AAAA,KAAA;IAKK,UAAU,GAAA;;;YACd,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,cAAc,EAAE;gBACxC,OAAO;aACR;AAED,YAAA,MAAM,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;AAGjC,YAAA,IAAI,IAAI,CAAC,YAAY,EAAE;AACrB,gBAAA,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC;aACpC;AAED,YAAA,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;AAClC,YAAA,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAC1B,YAAA,CAAA,EAAA,GAAA,MAAA,IAAI,CAAC,MAAM,EAAC,YAAY,kDAAI,CAAC;SAC9B,CAAA,CAAA;AAAA,KAAA;IAKD,OAAO,GAAA;QACL,IAAI,IAAI,CAAC,UAAU;YAAE,OAAO;AAE5B,QAAA,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;AACvB,QAAA,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;QAC7B,IAAI,CAAC,kBAAkB,EAAE,CAAC;AAC1B,QAAA,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;KACnC;AAKD,IAAA,YAAY,CAAC,MAAsC,EAAA;QACjD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QAEnC,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,WAAW,EAAE;YACrC,IAAI,CAAC,iBAAiB,EAAE,CAAC,KAAK,CAAC,KAAK,IAAG;AACrC,gBAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;AAC5B,aAAC,CAAC,CAAC;SACJ;KACF;IAIO,mBAAmB,GAAA;QACzB,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,WAAW,EAAE,MAAK;AACtC,YAAA,IAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;AAC/B,SAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,cAAc,EAAE,CAAC,MAAM,KAAI;;AAC/C,YAAA,IAAI,CAAC,GAAG,CAAC,sBAAsB,EAAE,MAAM,CAAC,CAAC;AACzC,YAAA,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;AAClC,YAAA,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAC1B,YAAA,CAAA,EAAA,GAAA,MAAA,IAAI,CAAC,MAAM,EAAC,YAAY,kDAAI,CAAC;AAC/B,SAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,KAAK,KAAI;;AAClD,YAAA,IAAI,CAAC,GAAG,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC;AAC7C,YAAA,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;AAC3B,YAAA,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;AACzB,YAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;YAC1B,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,IAAI,CAAC,MAAM,EAAC,OAAO,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,EAAA,EAAG,KAAK,CAAC,CAAC;AAC/B,SAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,oBAAoB,EAAE,CAAC,IAAI,KAAI;AACnD,YAAA,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC;AACtC,SAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,oBAAoB,EAAE,CAAC,KAAK,KAAI;AACpD,YAAA,IAAI,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;YACjC,IAAI,IAAI,CAAC,YAAY,IAAI,KAAK,CAAC,IAAI,KAAK,OAAO,EAAE;gBAC/C,MAAM,MAAM,GAAG,IAAI,WAAW,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;AACxC,gBAAA,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,MAAM,CAAC;AACrC,gBAAA,IAAI,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;aAC/C;AACH,SAAC,CAAC,CAAC;KACJ;AAEO,IAAA,wBAAwB,CAAC,IAA0B,EAAA;;QACzD,IAAI,OAAO,IAAI,KAAK,QAAQ;YAAE,OAAO;AAErC,QAAA,IAAI;YACF,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AAEjC,YAAA,QAAQ,OAAO,CAAC,IAAI;AAClB,gBAAA,KAAK,2BAA2B;AAC9B,oBAAA,IAAI,CAAA,CAAA,EAAA,GAAA,OAAO,CAAC,IAAI,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,IAAI,MAAK,WAAW,KAAI,CAAA,EAAA,GAAA,OAAO,CAAC,IAAI,0CAAE,OAAO,CAAA,EAAE;wBAC/D,MAAM,WAAW,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAM,KAAK,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC;wBAC7E,IAAI,WAAW,aAAX,WAAW,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAX,WAAW,CAAE,IAAI,EAAE;4BACrB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,WAAW,CAAC,IAAI,CAAC,CAAC;AAC5C,4BAAA,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,IAAI,CAAC,MAAM,EAAC,YAAY,MAAG,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,EAAA,EAAA,WAAW,EAAE,WAAW,CAAC,IAAI,CAAC,CAAC;AAC1D,4BAAA,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;AACvB,gCAAA,EAAE,EAAE,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,CAAA,IAAA,EAAO,IAAI,CAAC,GAAG,EAAE,CAAE,CAAA;AAC1C,gCAAA,IAAI,EAAE,WAAW;gCACjB,IAAI,EAAE,WAAW,CAAC,IAAI;AACtB,gCAAA,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;AACtB,6BAAA,CAAC,CAAC;yBACJ;qBACF;oBACD,MAAM;AAER,gBAAA,KAAK,uDAAuD;AAC1D,oBAAA,IAAI,OAAO,CAAC,UAAU,EAAE;wBACtB,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;AACvD,wBAAA,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,IAAI,CAAC,MAAM,EAAC,YAAY,MAAG,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,EAAA,EAAA,MAAM,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;qBACxD;oBACD,MAAM;AAER,gBAAA,KAAK,sBAAsB;AACzB,oBAAA,IAAI,OAAO,CAAC,KAAK,EAAE;wBACjB,MAAM,SAAS,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;wBAC7E,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;qBAC9C;oBACD,MAAM;AAER,gBAAA,KAAK,OAAO;AACV,oBAAA,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,KAAK,CAAC,CAAA,MAAA,OAAO,CAAC,KAAK,MAAE,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,OAAO,KAAI,eAAe,CAAC,CAAC,CAAC;oBACzE,MAAM;aACT;SACF;QAAC,OAAO,KAAK,EAAE;AACd,YAAA,IAAI,CAAC,GAAG,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC;SAC9C;KACF;IAEa,kBAAkB,GAAA;AAAC,QAAA,OAAA,SAAA,CAAA,IAAA,EAAA,SAAA,EAAA,KAAA,CAAA,EAAA,WAAA,OAAO,GAAG,KAAK,EAAA;YAC9C,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAI;AACrC,gBAAA,MAAM,KAAK,GAAG,UAAU,CAAC,MAAK;oBAC5B,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,kBAAkB,EAAE,OAAO,CAAC,CAAC;AACpD,oBAAA,MAAM,CAAC,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC,CAAC;iBAClD,EAAE,OAAO,CAAC,CAAC;gBAEZ,MAAM,OAAO,GAAG,MAAK;oBACnB,YAAY,CAAC,KAAK,CAAC,CAAC;AACpB,oBAAA,OAAO,EAAE,CAAC;AACZ,iBAAC,CAAC;AAGF,gBAAA,IAAI,IAAI,CAAC,aAAa,CAAC,iBAAiB,EAAE,EAAE;oBAC1C,YAAY,CAAC,KAAK,CAAC,CAAC;AACpB,oBAAA,OAAO,EAAE,CAAC;oBACV,OAAO;iBACR;gBAGD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,kBAAkB,EAAE,OAAO,CAAC,CAAC;AACvD,aAAC,CAAC,CAAC;SACJ,CAAA,CAAA;AAAA,KAAA;IAEa,iBAAiB,GAAA;;AAC7B,YAAA,MAAM,aAAa,GAAG;AACpB,gBAAA,IAAI,EAAE,gBAAgB;AACtB,gBAAA,OAAO,EAAE;AACP,oBAAA,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK;AACxB,oBAAA,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU;AAClC,oBAAA,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,YAAY;AACtC,oBAAA,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK;AACxB,oBAAA,kBAAkB,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB;AAChD,oBAAA,mBAAmB,EAAE,IAAI,CAAC,MAAM,CAAC,iBAAiB;oBAClD,yBAAyB,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB,GAAG;AACxD,wBAAA,KAAK,EAAE,WAAW;qBACnB,GAAG,IAAI;AACR,oBAAA,cAAc,EAAE,IAAI,CAAC,MAAM,CAAC,aAAa;AACzC,oBAAA,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,WAAW;AACpC,oBAAA,iBAAiB,EAAE,IAAI,CAAC,MAAM,CAAC,eAAe,KAAK,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe;AAC9F,iBAAA;aACF,CAAC;AAEF,YAAA,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC,CAAC;SAC5D,CAAA,CAAA;AAAA,KAAA;AAEO,IAAA,YAAY,CAAC,MAAsC,EAAA;;QACzD,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,MAAM,EAAE;AAChC,YAAA,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;AAC3B,YAAA,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;YACnC,CAAA,EAAA,GAAA,CAAA,EAAA,GAAA,IAAI,CAAC,MAAM,EAAC,cAAc,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,EAAA,EAAG,MAAM,CAAC,CAAC;SACtC;KACF;AAEO,IAAA,GAAG,CAAC,OAAe,EAAE,GAAG,IAAW,EAAA;AACzC,QAAA,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;YACrB,OAAO,CAAC,GAAG,CAAC,CAAoB,iBAAA,EAAA,OAAO,EAAE,EAAE,GAAG,IAAI,CAAC,CAAC;SACrD;KACF;AACF;;AC3WM,MAAM,oBAAoB,GAAG,qCAAqC;AAClE,MAAM,wBAAwB,GAAG,aAAa;AAG9C,MAAM,mBAAmB,GAAG,MAAM;AAClC,MAAM,qBAAqB,GAAG,EAAE;AAG1B,MAAA,cAAc,GAAG;AAC5B,IAAA,QAAQ,EAAE,2BAA2B;AACrC,IAAA,mBAAmB,EAAE,gCAAgC;AACrD,IAAA,eAAe,EAAE,4BAA4B;AAC7C,IAAA,aAAa,EAAE,uBAAuB;AACtC,IAAA,wBAAwB,EAAE,4BAA4B;AACtD,IAAA,sBAAsB,EAAE,+BAA+B;AACvD,IAAA,iBAAiB,EAAE,8BAA8B;AACjD,IAAA,gBAAgB,EAAE,6BAA6B;;;ACd3C,MAAO,aAAc,SAAQ,KAAK,CAAA;AACtC,IAAA,WAAA,CAAY,OAAe,EAAA;QACzB,KAAK,CAAC,OAAO,CAAC,CAAC;AACf,QAAA,IAAI,CAAC,IAAI,GAAG,eAAe,CAAC;KAC7B;AACF,CAAA;AAKK,MAAO,WAAY,SAAQ,aAAa,CAAA;AAC5C,IAAA,WAAA,CAAY,OAAe,EAAA;QACzB,KAAK,CAAC,OAAO,CAAC,CAAC;AACf,QAAA,IAAI,CAAC,IAAI,GAAG,aAAa,CAAC;KAC3B;AACF,CAAA;AAKK,MAAO,UAAW,SAAQ,aAAa,CAAA;AAC3C,IAAA,WAAA,CAAY,OAAe,EAAA;QACzB,KAAK,CAAC,OAAO,CAAC,CAAC;AACf,QAAA,IAAI,CAAC,IAAI,GAAG,YAAY,CAAC;KAC1B;AACF;;;;","x_google_ignoreList":[0]}